TYPE Tile
    x AS SINGLE
    y AS SINGLE
    tx AS INTEGER
    ty AS INTEGER
END TYPE

CONST TILE_SIZE = 16

REDIM SHARED Tiles(0) AS Tile

COMMON SHARED tileset&, layer1&

TILESET:
DATA 16,0,0,0,80,0,16,0,96,0,32,0,112,0,48,0,128,0,64,0,144,0,96,0,160,0,96,0,176,0,96,0,192,0,96,0,208,0,96,0,224,0,96,0,240,0,96,0,256,0,96,0,272,0,96,0,288,0,96,0,304,0,96,0,320,0,128,0,336,0,144,0,80,16,16,16,96,16,32,16,112,16,48,16,128,16,64,16,144,16,96,16,160,16,96,16,176,16,96,16,192,16,96,16,208,16,96,16,224,16,96,16,240,16,96,16,256,16,96,16,272,16,96,16,288,16,96,16,304,16,96,16,320,16,128,16,336,16,144,16,80,32,16,32,96,32,32,32,112,32,48,32,128,32,64,32,144,32,96,32,160,32,96,32,176,32,96,32,192,32,96,32,208,32,96,32,224,32,96,32,240,32,96,32,256,32,96,32,272,32,96,32,288,32,96,32,304,32,96,32,320,32,128,32,336,32,144,32,80,48,16,48,96,48,32,48,112,48,48,48,128,48,64,48,144,48,96,48,160,48,96,48,176,48,96,48,192,48,96,48,208,48,96,48,224,48,96,48,240,48,96,48,256,48,96,48,272,48,96,48,288,48,96,48,304,48,96,48,320,48,128,48,336,48,144,48,80,64,16,64,96,64,16,96,112,64,48,64,128,64,64,64,144,64,96,64,160,64,96,64,176,64,96,64,192,64,96,64,208,64,96,64,224,64,96,64,240,64,96,64,256,64,96,64,272,64,96,64,288,64,96,64,304,64,96,64,320,64,128,64,336,64,144,64,80,80,16,96,96,80,16,96,112,80,32,48,128,80,64,96,144,80,112,96,160,80,112,96,176,80,112,96,192,80,112,96,208,80,112,96,224,80,112,96,240,80,112,96,256,80,112,96,272,80,160,16,288,80,176,16,304,80,112,96,320,80,224,96,80,96,16,96,96,96,16,96,112,96,32,64,128,96,64,112,144,96,112,96,160,96,112,96,176,96,112,96,192,96,112,96,208,96,112,96,224,96,112,96,240,96,112,96,256,96,112,96,272,96,160,32,288,96,176,32,304,96,112,96,320,96,224,112,80,112,16,96,96,112,16,96,112,112,16,96,128,112,64,112,144,112,112,96,160,112,208,16,176,112,224,16,192,112,112,96,208,112,112,96,224,112,112,96,240,112,112,96,256,112,112,96,272,112,160,48,288,112,176,48,304,112,112,96,320,112,224,112,352,112,272,80,368,112,288,80,80,128,16,96,96,128,16,96,112,128,16,96,128,128,64,96,144,128,112,96,160,128,208,32,176,128,224,32,192,128,112,96,208,128,112,96,224,128,112,96,240,128,160,96,256,128,176,96,272,128,160,64,288,128,176,64,304,128,112,96,320,128,224,96,352,128,272,96,368,128,288,96,80,144,16,96,96,144,16,96,112,144,16,112,128,144,64,112,144,144,112,96,160,144,208,48,176,144,224,48,192,144,112,96,208,144,112,96,224,144,112,96,240,144,160,112,256,144,176,112,272,144,176,112,288,144,192,112,304,144,112,96,320,144,224,112,352,144,272,128,368,144,288,128,0,160,352,80,16,160,368,80,80,160,16,96,96,160,16,96,112,160,16,96,128,160,64,96,144,160,160,96,160,160,208,64,176,160,224,64,192,160,192,96,208,160,112,96,224,160,112,96,240,160,112,96,256,160,112,96,272,160,112,96,288,160,112,96,304,160,112,96,320,160,224,96,352,160,272,128,368,160,288,128,0,176,352,96,16,176,368,96,80,176,16,96,96,176,16,96,112,176,16,112,128,176,64,112,144,176,160,112,160,176,176,112,176,176,176,112,192,176,192,112,208,176,112,96,224,176,112,96,240,176,112,96,256,176,112,96,272,176,112,96,288,176,112,96,304,176,112,96,320,176,224,112,352,176,272,128,368,176,288,128,0,192,272,128,16,192,288,128,80,192,16,96,96,192,16,96,112,192,16,144,128,192,64,144,144,192,80,144,160,192,112,96,176,192,112,96,192,192,160,144,208,192,176,144,224,192,192,144,240,192,112,144,256,192,112,144,272,192,128,144,288,192,224,144,304,192,160,144,320,192,176,144,352,192,272,128,368,192,288,128,0,208,272,160,16,208,288,160,32,208,320,128,48,208,320,128,64,208,336,128,80,208,16,160,96,208,16,160,112,208,16,160,128,208,64,160,144,208,80,160,160,208,224,160,176,208,128,160,192,208,160,160,208,208,176,160,224,208,192,160,240,208,112,160,256,208,112,160,272,208,128,160,288,208,224,160,304,208,160,160,320,208,176,160,336,208,320,128,352,208,272,160,368,208,288,160,0,224,320,144,16,224,336,144,32,224,320,144,48,224,320,144,64,224,336,144,80,224,320,144,96,224,320,144,112,224,320,144,128,224,320,144,144,224,336,144,160,224,320,144,176,224,336,144,192,224,320,144,208,224,336,144,224,224,320,144,240,224,336,144,256,224,320,144,272,224,320,144,288,224,336,144,304,224,320,144,320,224,320,144,336,224,320,144,352,224,320,144,368,224,336,144,0,240,320,160,16,240,336,160,32,240,320,160,48,240,320,160,64,240,336,160,80,240,320,160,96,240,320,160,112,240,320,160,128,240,320,160,144,240,336,160,160,240,320,160,176,240,336,160,192,240,320,160,208,240,336,160,224,240,320,160,240,240,336,160,256,240,320,160,272,240,320,160,288,240,336,160,304,240,320,160,320,240,320,160,336,240,320,160,352,240,320,160,368,240,336,160
